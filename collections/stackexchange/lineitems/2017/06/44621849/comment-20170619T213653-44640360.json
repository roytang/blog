{"id": 44640360, "name": "Dave Cassel", "url": "https://stackoverflow.com/users/237867/dave-cassel", "text": "I don't think there's an out-of-the-box group by, but you can build an extension to do it. I made some sample docs like this:\r\n\r\n    declareUpdate();\r\n\r\n    for (let index=0; index < 1000; index++) {\r\n      xdmp.documentInsert(\r\n        '/values' + index + '.json',\r\n        {\r\n          \"name\": \"val\" + (xdmp.random(2) + 1),\r\n          \"amount\": xdmp.random(2) + 1\r\n        }\r\n      )\r\n    }\r\n\r\nI ran this code in Query Console:\r\n\r\n    'use strict';\r\n\r\n    var jsearch = require('/MarkLogic/jsearch.sjs');\r\n    var tuples = \r\n      jsearch.tuples(\r\n        [\r\n          cts.jsonPropertyReference('name'), \r\n          cts.jsonPropertyReference('amount', [\"type=int\"])\r\n        ]\r\n      )\r\n        .slice(0, 1000) // get all the values\r\n        .map({frequency: \"item\", names: ['name', 'count', 'frequency']})\r\n        .result();\r\n\r\n    tuples\r\n      .reduce(function(acc, current, index, array) {\r\n        acc[current.name] = parseInt(current.count, 10) * current.frequency;\r\n        return acc;\r\n      }, {});\r\n\r\nThat got me a response of: \r\n\r\n    {\r\n      \"val1\": 381, \r\n      \"val2\": 351, \r\n      \"val3\": 324\r\n    }\r\n\r\nI think that's what you're looking for. Other stuff you'll need:\r\n\r\n- [docs on creating a REST extension](http://docs.marklogic.com/guide/rest-dev/extensions#id_21018)\r\n- [calling a REST extension from the Node.js Client API](http://docs.marklogic.com/guide/node-dev/extensions#id_66908)\r\n- and you'll need range indexes on `name` (string) and `count` (int). ", "date": "2017-06-19 21:36:53", "photo": "https://www.gravatar.com/avatar/a71246f507b4964e3006f68f9ba38783?s=128&d=identicon&r=PG", "source_url": "https://stackoverflow.com/questions/44621849/marklogic-node-js-api-group-by-sum", "mention_url": "https://stackoverflow.com/questions/44621849/marklogic-node-js-api-group-by-sum", "source": "stackexchange"}